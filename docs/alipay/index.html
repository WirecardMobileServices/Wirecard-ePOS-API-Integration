



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>Alipay - Wirecard ePOS API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../stylesheets/minimal-epossdk.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#workflow" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Wirecard ePOS API" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Wirecard ePOS API
            </span>
            <span class="md-header-nav__topic">
              Alipay
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Wirecard ePOS API" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Wirecard ePOS API
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Start
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Start
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Core Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Core Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      Sale Model
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Sale Model
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../sale-general/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-2" type="checkbox" id="nav-3-2-2" checked>
    
    <label class="md-nav__link" for="nav-3-2-2">
      Payment Methods
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-2">
        Payment Methods
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cash/" title="Cash" class="md-nav__link">
      Cash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../card/" title="Card" class="md-nav__link">
      Card
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Alipay
      </label>
    
    <a href="./" title="Alipay" class="md-nav__link md-nav__link--active">
      Alipay
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#workflow" title="Workflow" class="md-nav__link">
    Workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#purchase-operation" title="Purchase Operation" class="md-nav__link">
    Purchase Operation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-cancel-operation" title="Reverse &amp; Cancel Operation" class="md-nav__link">
    Reverse &amp; Cancel Operation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reverse-request" title="Reverse Request" class="md-nav__link">
    Reverse Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-response" title="Reverse Response" class="md-nav__link">
    Reverse Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancel-request" title="Cancel Request" class="md-nav__link">
    Cancel Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancel-response" title="Cancel Response" class="md-nav__link">
    Cancel Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return-operation" title="Return Operation" class="md-nav__link">
    Return Operation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_1" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_1" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-a-sale-call" title="GET a Sale Call" class="md-nav__link">
    GET a Sale Call
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../wechat/" title="WeChat Pay" class="md-nav__link">
      WeChat Pay
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multi-tender/" title="Multi-tender Sale" class="md-nav__link">
      Multi-tender Sale
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user/" title="User Management" class="md-nav__link">
      User Management
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Advanced Integration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Advanced Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../advanced_overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Sale Items
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Sale Items
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../items/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../discounts/" title="Discounts" class="md-nav__link">
      Discounts
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Product Catalogue
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Product Catalogue
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="Categories" class="md-nav__link">
      Categories
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="Product stock" class="md-nav__link">
      Product stock
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Merchant Management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Merchant Management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../merchant-management/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="Shop Management" class="md-nav__link">
      Shop Management
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Cash Register
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Cash Register
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="Shift" class="md-nav__link">
      Shift
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../shift_reports/" title="Shift Report" class="md-nav__link">
      Shift Report
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../terminal-management/" title="Terminal management" class="md-nav__link">
      Terminal management
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#workflow" title="Workflow" class="md-nav__link">
    Workflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#purchase-operation" title="Purchase Operation" class="md-nav__link">
    Purchase Operation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse-cancel-operation" title="Reverse &amp; Cancel Operation" class="md-nav__link">
    Reverse &amp; Cancel Operation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reverse-request" title="Reverse Request" class="md-nav__link">
    Reverse Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-response" title="Reverse Response" class="md-nav__link">
    Reverse Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancel-request" title="Cancel Request" class="md-nav__link">
    Cancel Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancel-response" title="Cancel Response" class="md-nav__link">
    Cancel Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return-operation" title="Return Operation" class="md-nav__link">
    Return Operation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_1" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_1" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-a-sale-call" title="GET a Sale Call" class="md-nav__link">
    GET a Sale Call
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Alipay</h1>
                
                <p>Wirecard makes it easy for you to accept Alipay, one of the most popular payment platforms in China. Grow your sales revenues by letting Chinese tourists use their preferred payment method.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Visit <a href="https://www.wirecard.com/payment-base/alipay">Wirecard</a> website to find out all benefits of Alipay barcode payment.</p>
</div>
<p>From retailer perspective, Alipay payment is very straightforward. Only one request is needed to successfully complete Alipay payment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sale requests are serviced at <a href="https://switch.wirecard.com/mswitch-server/v1/sales">https://switch.wirecard.com/mswitch-server/v1/sales</a> URL.</p>
</div>
<h2 id="workflow">Workflow</h2>
<h2 id="purchase-operation">Purchase Operation</h2>
<p>In context of Wirecard ePOS, every payment transaction is part of a <em>Sale</em>. In order to process Alipay payment, call Wirecard ePOS with <em>Sale-PURCHASE</em> request defined below:</p>
<h3 id="request">Request</h3>
<div class="codehilite"><pre><span></span>{
    &quot;multitender&quot;: &quot;true&quot;,
    &quot;operation&quot; : &quot;PURCHASE&quot;,
    &quot;externalId&quot;: &quot;123456789&quot;,
    &quot;totalAmount&quot; : 10,
    &quot;currencyCode&quot; : &quot;EUR&quot;,
    &quot;payments&quot; : [
        {
            &quot;paymentMethod&quot; : &quot;ALIPAY&quot;,
            &quot;transactionType&quot; : &quot;PURCHASE&quot;,
            &quot;amount&quot; : 10,
            &quot;consumerId&quot; : &quot;28050011719660761&quot;
        }
    ]
}
</pre></div>


<ul>
<li><strong>"multitender"</strong> - boolean flag<ul>
<li>"TRUE" - required; compliant with newest Sale Model, which is described in this integration guide</li>
<li>"FALSE" - deprecated; old Sale Model is not addressed in this integration guide</li>
</ul>
</li>
<li><strong>"operation"</strong> - defines type of Sale request; "PURCHASE" operation creates new Sale-Purchase record</li>
<li><strong><em>"externalId"</em></strong> - <em>optional</em> - meant to be used for integrator tracking purpose; it is forwarded to payment gateway</li>
<li><strong>"totalAmount"</strong> - defines amount of Sale-Purchase </li>
<li><strong>"currencyCode"</strong> - defines currency, based on <a href="https://en.wikipedia.org/wiki/ISO_4217">ISO 4217</a> standard</li>
<li><strong>"payments"</strong> - payment-specific information; one payment transaction per one request is supported<ul>
<li><strong>"paymentMethod"</strong> - defines payment method</li>
<li><strong>"transactionType"</strong> - defines type of this transaction; "PURCHASE" transaction type moves funds from end-consumer to merchant</li>
<li><strong>"amount"</strong> - defines transaction amount</li>
<li><strong>"consumerId"</strong> - value of scanned barcode (QR code)</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In context of Wirecard ePOS, term <strong>Purchase</strong> is used for both:</p>
<ul>
<li>type of Sale - defined more specifically as <em>Sale-Purchase</em></li>
<li>transaction type - e.g. alipay <em>purchase</em> transaction, cash <em>purchase</em> transaction, etc.</li>
</ul>
</div>
<h3 id="response">Response</h3>
<p>Code <strong>1000</strong> indicates that Alipay purchase transaction is completed successfully.</p>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot;: &quot;PURCHASE&quot;,
    &quot;timeStamp&quot;: &quot;2019-04-12T12:27:43.069Z&quot;,
    &quot;status&quot;: {
        &quot;code&quot;: &quot;1000&quot;,
        &quot;result&quot;: &quot;SUCCESS&quot;
    },
    &quot;id&quot;: &quot;a66bbac362404fcc9c08868f881f94d9&quot;,
    &quot;externalCashierId&quot;: null,
    &quot;payments&quot;: [
        {
            &quot;paymentMethod&quot;: &quot;ALIPAY&quot;,
            &quot;transactionType&quot;: &quot;PURCHASE&quot;,
            &quot;id&quot;: &quot;a2a688bafd0e43a5965ec639daf17dc7&quot;,
            &quot;timeStamp&quot;: &quot;2019-04-12T12:27:42.963Z&quot;,
            &quot;statuses&quot;: [
                {
                    &quot;result&quot;: &quot;SUCCESS&quot;,
                    &quot;code&quot;: &quot;1000&quot;,
                    &quot;message&quot;: &quot;Transaction OK.&quot;
                }
            ],
            &quot;alipayPayTime&quot;: &quot;20190412202742&quot;,
            &quot;alipayTransId&quot;: &quot;2019041220001004050261859239&quot;,
            &quot;alipayBuyerLoginId&quot;: &quot;int*@service.*&quot;,
            &quot;exchangeRate&quot;: 6.9187,
            &quot;transAmountCny&quot;: 691.87,
            &quot;merchantName&quot;: &quot;MA-SWITCH-01&quot;,
            &quot;terminalId&quot;: &quot;1234567&quot;,
            &quot;gatewayReference&quot;: &quot;20e66beb-b47a-4d51-9ea6-31e30ca6a040&quot;
        }
    ],
    &quot;externalId&quot;: &quot;123456789&quot;,
    &quot;merchantReceiptId&quot;: 250,
    &quot;multitender&quot;: true
}
</pre></div>


<ul>
<li><strong>"operation"</strong> - echoed from request</li>
<li><strong>"timeStamp"</strong> - date-time when response was constructed</li>
<li><strong>"status"</strong><ul>
<li><strong>"code"</strong> - code "1000" means operation is successful</li>
<li><strong>"result"</strong> - "SUCCESS" means operation is successful</li>
</ul>
</li>
<li><strong>"id"</strong> - Sale-Purchase identifier assigned by Wirecard ePOS system</li>
<li><strong>"externalCashierId"</strong> - relevant for <a href="../advanced_overview/">Advanced Integration</a>; otherwise null</li>
<li><strong>"payments"</strong> - specific information for every payment method<ul>
<li><strong>"paymentMethod"</strong> - echoed from request</li>
<li><strong>"transactionType"</strong> - echoed from request</li>
<li><strong>"id"</strong> - identifier of purchase transaction assigned by Wirecard ePOS system</li>
<li><strong>"timeStamp"</strong> - date-time when transaction was processed by payment gateway</li>
<li><strong>"statuses"</strong><ul>
<li><strong>"result"</strong> - "SUCCESS" means transaction is successful</li>
<li><strong>"code"</strong> - code "1000" means transaction is successful</li>
<li><strong>"message"</strong> - message provided by payment gateway</li>
</ul>
</li>
<li><strong>"alipayPayTime"</strong> - date-time in Alipay system</li>
<li><strong>"alipayTransId"</strong> - transaction identifier in Alipay System</li>
<li><strong>"alipayBuyerLoginId"</strong> - end-consumer (buyer) identifier in Alipay system</li>
<li><strong>"exchangeRate"</strong> - exchange rate between Sale currency and CNY</li>
<li><strong>"transAmountCny"</strong> - amount in CNY (Chinese Yuan)</li>
<li><strong>"merchantName"</strong> - merchant name in Alipay system</li>
<li><strong>"terminalId"</strong> - terminal identifier</li>
<li><strong>"gatewayReference"</strong> - transaction identifier in Wirecard payment gateway</li>
</ul>
</li>
<li><strong>"externalId"</strong> - echoed from request</li>
<li><strong>"merchantReceiptId"</strong> - unique identifier per merchant; it is incremented with every Sale-Purchase and Sale-Return; advised to be printed on receipt as a barcode</li>
<li><strong>"multitender"</strong> - echoed from request</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>After successful PURCHASE operation, <a href="#get-a-sale-call">GET a Sale call</a> is advised, as it provides complete Sale information.</p>
</div>
<h2 id="reverse-cancel-operation">Reverse &amp; Cancel Operation</h2>
<p><em>REVERSE</em> operation is typically used in case <em>Sale-Purchase</em> was created accidentally. <em>REVERSE</em> operation serves for reversing particular <em>purchase</em> transaction.</p>
<p><em>REVERSE</em> operation moves <em>Sale-Purchase</em> to UNCONFIRMED (OPEN) state, which is interim state. After successful reversal, it is advised to send <em>CANCEL</em> operation, which moves <em>Sale-Purchase</em> to CANCELED state. CANCELED state is final state.</p>
<p>In order to reverse Alipay purchase transaction, call Wirecard ePOS with <em>Sale-REVERSE</em> request defined below:</p>
<h3 id="reverse-request">Reverse Request</h3>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot;: &quot;REVERSE&quot;,
    &quot;originalSaleId&quot;: &quot;a66bbac362404fcc9c08868f881f94d9&quot;,
    &quot;payments&quot;: [
        { 
            &quot;paymentMethod&quot;: &quot;ALIPAY&quot;,
            &quot;transactionType&quot;: &quot;REVERSAL&quot;,
            &quot;originalTransactionId&quot; : &quot;a2a688bafd0e43a5965ec639daf17dc7&quot;
        }
    ]
}
</pre></div>


<ul>
<li><strong>"operation"</strong> - defines type of Sale request</li>
<li><strong>"originalSaleId"</strong> - identifier of original Sale-Purchase</li>
<li><strong>"payments"</strong> - payment-specific information; one payment transaction per request is supported<ul>
<li><strong>"paymentMethod"</strong> - defines payment method; it must be same as original payment transaction</li>
<li><strong>"transactionType"</strong> - defines type of this transaction; REVERSE operation must include REVERSAL transaction type</li>
<li><strong>"originalTransactionId"</strong> - identifier of original purchase transaction</li>
</ul>
</li>
</ul>
<h3 id="reverse-response">Reverse Response</h3>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot;: &quot;REVERSE&quot;,
    &quot;timeStamp&quot;: &quot;2019-04-12T12:27:59.86Z&quot;,
    &quot;status&quot;: {
        &quot;code&quot;: &quot;1000&quot;,
        &quot;result&quot;: &quot;SUCCESS&quot;
    },
    &quot;id&quot;: &quot;a66bbac362404fcc9c08868f881f94d9&quot;,
    &quot;externalCashierId&quot;: null,
    &quot;payments&quot;: [
        {
            &quot;paymentMethod&quot;: &quot;ALIPAY&quot;,
            &quot;transactionType&quot;: &quot;REVERSAL&quot;,
            &quot;id&quot;: &quot;3a91fdb770004ba687c006fe2f2e122b&quot;,
            &quot;timeStamp&quot;: &quot;2019-04-12T12:27:59.817Z&quot;,
            &quot;statuses&quot;: [
                {
                    &quot;result&quot;: &quot;SUCCESS&quot;,
                    &quot;code&quot;: &quot;1000&quot;,
                    &quot;message&quot;: &quot;Transaction OK.&quot;
                }
            ],
            &quot;alipayPayTime&quot;: &quot;20190412202742&quot;,
            &quot;alipayTransId&quot;: &quot;2019041220001004050261859239&quot;,
            &quot;alipayBuyerLoginId&quot;: &quot;int*@service.*&quot;,
            &quot;exchangeRate&quot;: 6.9187,
            &quot;transAmountCny&quot;: 691.87,
            &quot;merchantName&quot;: &quot;MA-SWITCH-01&quot;,
            &quot;terminalId&quot;: &quot;1234567&quot;,
            &quot;alipayCancelTime&quot;: &quot;20190412202759&quot;,
            &quot;gatewayReference&quot;: &quot;49e3a790-874f-49ed-b690-e553b59249d6&quot;
        }
    ]
}
</pre></div>


<p>In order to explicitly change state of Sale-Purchase to CANCELED, call Wirecard ePOS with <em>Sale-CANCEL</em> request defined below:</p>
<h3 id="cancel-request">Cancel Request</h3>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot;: &quot;CANCEL&quot;,
    &quot;originalSaleId&quot;: &quot;a66bbac362404fcc9c08868f881f94d9&quot;
}
</pre></div>


<ul>
<li><strong>"operation"</strong> - defines type of Sale request</li>
<li><strong>"originalSaleId"</strong> - identifier of original Sale-Purchase</li>
</ul>
<h3 id="cancel-response">Cancel Response</h3>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot;: &quot;CANCEL&quot;,
    &quot;timeStamp&quot;: &quot;2019-04-12T12:46:38.229Z&quot;,
    &quot;status&quot;: {
        &quot;code&quot;: &quot;1000&quot;,
        &quot;result&quot;: &quot;SUCCESS&quot;
    },
    &quot;id&quot;: &quot;a66bbac362404fcc9c08868f881f94d9&quot;,
    &quot;externalCashierId&quot;: null
}
</pre></div>


<h2 id="return-operation">Return Operation</h2>
<p><em>RETURN</em> operation is used in case end-consumer returns merchandise and asks for a refund. Wirecard ePOS support partial as well as full returns.</p>
<p>In order to refund alipay purchase transaction, call Wirecard ePOS with <em>Sale-RETURN</em> request defined below:</p>
<h3 id="request_1">Request</h3>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot; : &quot;RETURN&quot;,
    &quot;totalAmount&quot; : 100,
    &quot;currencyCode&quot; : &quot;EUR&quot;,
    &quot;originalSaleId&quot; : &quot;d79dc95ee0e041ed8657a763cafded51&quot;,
    &quot;payments&quot; : [ 
        {
            &quot;paymentMethod&quot; : &quot;ALIPAY&quot;,
            &quot;transactionType&quot; : &quot;REFERENCE_REFUND&quot;,
            &quot;amount&quot; : 100,
            &quot;originalTransactionId&quot; : &quot;b1c4a37810ac43f598f29450c760b90d&quot;
        }
    ]
}
</pre></div>


<ul>
<li><strong>"operation"</strong> - defines type of Sale request</li>
<li><strong>"totalAmount"</strong> - defines amount to be refunded; it can be equal (full return) or less (partial return) than totalAmount in original Sale-Purchase</li>
<li><strong>"currencyCode"</strong> - must be same as for original Sale-Purchase</li>
<li><strong>"originalSaleId"</strong> - identifier of original Sale-Purchase</li>
<li><strong>"payments"</strong> - payment-specific information; one payment transaction per request is supported<ul>
<li><strong>"paymentMethod"</strong> - defines payment method</li>
<li><strong>"transactionType"</strong> - defines type of this transaction; must be "REFERENCE_REFUND" when payment method is ALIPAY</li>
<li><strong>"amount"</strong> - defines amount to be refunded</li>
<li><strong>"originalTransactionId"</strong> - identifier of original alipay purchase transaction</li>
</ul>
</li>
</ul>
<h3 id="response_1">Response</h3>
<div class="codehilite"><pre><span></span>{
    &quot;operation&quot;: &quot;RETURN&quot;,
    &quot;timeStamp&quot;: &quot;2019-04-12T12:52:30.218Z&quot;,
    &quot;status&quot;: {
        &quot;code&quot;: &quot;1000&quot;,
        &quot;result&quot;: &quot;SUCCESS&quot;
    },
    &quot;id&quot;: &quot;d79dc95ee0e041ed8657a763cafded51&quot;,
    &quot;externalCashierId&quot;: null,
    &quot;payments&quot;: [
        {
            &quot;paymentMethod&quot;: &quot;ALIPAY&quot;,
            &quot;transactionType&quot;: &quot;REFERENCE_REFUND&quot;,
            &quot;id&quot;: &quot;8516d319573146a0a4853b48482ce0d5&quot;,
            &quot;timeStamp&quot;: &quot;2019-04-12T12:52:30.092Z&quot;,
            &quot;statuses&quot;: [
                {
                    &quot;result&quot;: &quot;SUCCESS&quot;,
                    &quot;code&quot;: &quot;1000&quot;,
                    &quot;message&quot;: &quot;Transaction OK.&quot;
                }
            ],
            &quot;alipayPayTime&quot;: &quot;20190412205203&quot;,
            &quot;alipayTransId&quot;: &quot;2019041220001004050261859239&quot;,
            &quot;alipayBuyerLoginId&quot;: &quot;int*@service.*&quot;,
            &quot;exchangeRate&quot;: 6.9187,
            &quot;transAmountCny&quot;: 691.87,
            &quot;merchantName&quot;: &quot;MA-SWITCH-01&quot;,
            &quot;terminalId&quot;: &quot;1234567&quot;,
            &quot;refundAmountCny&quot;: 691.87,
            &quot;refundExchangeRate&quot;: 6.9187,
            &quot;gatewayReference&quot;: &quot;0f27700f-29db-4843-b73c-ffba2442e7f4&quot;
        }
    ],
    &quot;externalId&quot;: null,
    &quot;merchantReceiptId&quot;: 252
}
</pre></div>


<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>See also complete list of Wirecard ePOS Sale <a href="https://switch-test.wirecard.com/mswitch-server/doc/api-doc-sale-examples.html">request &amp; response examples</a>.</p>
</div>
<h2 id="get-a-sale-call">GET a Sale Call</h2>
<p>You can see below an example of GET a Sale call with excluded <em>merchant</em> and <em>user</em> fields which are going to be described in <a href="../merchant-management/">Merchant Management</a> and <a href="../user/">User Management</a> respectively.</p>
<div class="codehilite"><pre><span></span>GET https://switch-test.wirecard.com/mswitch-server/v1/sales/6434f3ee5f404fec89d95c7f8538ac68?excludeField=merchant&amp;excludeField=user

{
    &quot;id&quot;: &quot;6434f3ee5f404fec89d95c7f8538ac68&quot;,
    &quot;type&quot;: &quot;PURCHASE&quot;,
    &quot;status&quot;: &quot;COMPLETED&quot;,
    &quot;totalAmount&quot;: 100,
    &quot;note&quot;: null,
    &quot;externalId&quot;: null,
    &quot;externalCashierId&quot;: null,
    &quot;customerId&quot;: null,
    &quot;initialized&quot;: &quot;2019-04-12T13:23:48.571Z&quot;,
    &quot;shop&quot;: null,
    &quot;currency&quot;: {
        &quot;number&quot;: 978,
        &quot;code&quot;: &quot;EUR&quot;,
        &quot;name&quot;: &quot;Euro&quot;,
        &quot;minorUnit&quot;: 2
    },
    &quot;unitPricesIncludeTax&quot;: null,
    &quot;items&quot;: [       
    ],
    &quot;transactions&quot;: [
        {
            &quot;type&quot;: &quot;ALIPAY_PURCHASE&quot;,
            &quot;id&quot;: &quot;587b078f93c849a2a1915c7c396cf15d&quot;,
            &quot;status&quot;: &quot;COMPLETED&quot;,
            &quot;amount&quot;: 100,
            &quot;lastUpdated&quot;: &quot;2019-04-12T13:23:48.66Z&quot;,
            &quot;initialized&quot;: &quot;2019-04-12T13:23:48.573Z&quot;,
            &quot;message&quot;: &quot;The resource was successfully created on Alipay side.&quot;,
            &quot;gateway&quot;: {
                &quot;id&quot;: &quot;wdEeSimulated&quot;,
                &quot;name&quot;: &quot;Wirecard EE Simulated&quot;,
                &quot;type&quot;: &quot;WIRECARD_EE_SIMULATED&quot;,
                &quot;url&quot;: &quot;http://dummy&quot;
            },
            &quot;gatewayReference&quot;: &quot;f40369c5-3f88-4492-8d23-268d3c4f14dc&quot;,
            &quot;processedByGateway&quot;: &quot;2019-04-12T13:23:48.644Z&quot;,
            &quot;alipayPayTime&quot;: &quot;20190412212348&quot;,
            &quot;alipayTransId&quot;: &quot;2019041221001004050261859239&quot;,
            &quot;alipayBuyerLoginId&quot;: &quot;int*@service.*&quot;,
            &quot;exchangeRate&quot;: 6.9187,
            &quot;transAmountCny&quot;: 691.87,
            &quot;merchantName&quot;: &quot;MA-SWITCH-01&quot;,
            &quot;terminalId&quot;: &quot;1234567&quot;,
            &quot;alipayConsumerAccountId&quot;: &quot;2088122878784050&quot;,
            &quot;autoResolveTransactions&quot;: [           
            ],
            &quot;transactionBarcodeId&quot;: &quot;28050011719660761&quot;
        }
    ],
    &quot;location&quot;: null,
    &quot;clientInfo&quot;: null,
    &quot;merchantReceiptId&quot;: 254,
    &quot;cancelledBy&quot;: null,
    &quot;shiftId&quot;: null,
    &quot;cashRegisterId&quot;: null,
    &quot;emailForReceiptProvided&quot;: false,
    &quot;multitender&quot;: true
}
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../card/" title="Card" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Card
              </span>
            </div>
          </a>
        
        
          <a href="../wechat/" title="WeChat Pay" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                WeChat Pay
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/WirecardMobileServices/Wirecard-ePOS-iOS/issues" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/WirecardMobileServices/Wirecard-ePOS-iOS" class="md-footer-social__link fa fa-apple"></a>
    
      <a href="https://github.com/WirecardMobileServices/Wirecard-ePOS-Android" class="md-footer-social__link fa fa-android"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.2ba8dec4.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../javascript/external-links.js"></script>
      
    
  </body>
</html>